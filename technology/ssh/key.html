<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.49" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://sunzhenyang.github.io/technology/ssh/key.html"><meta property="og:site_name" content="Yang's Blog"><meta property="og:title" content="密钥登录"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-10-14T09:12:02.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="ssh"><meta property="article:modified_time" content="2022-10-14T09:12:02.000Z"><link rel="icon" href="/favicon.ico"><meta keywords="孙振洋,sunzhenyang,Ethan,Yang,Blog,个人博客"><meta description="孙振洋,sunzhenyang,Ethan,Yang,Blog,个人博客"><meta author="孙振洋"><script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?31eccf4300a72d3df15680f6efc07f1c";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script><title>密钥登录 | Yang's Blog</title><meta name="description" content="今日事，今日毕！">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.cfc09b30.css">
    <link rel="modulepreload" href="/assets/app.5b67e1df.js"><link rel="modulepreload" href="/assets/key.html.2d2b4a16.js"><link rel="modulepreload" href="/assets/key.html.2e4eb3cb.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/avatar.png" alt="Yang&#39;s Blog"><!----><span class="site-name hide-in-pad">Yang&#39;s Blog</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="首页"><span class="icon iconfont icon-home"></span>首页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="前端开发"><span class="title"><span class="icon iconfont icon-html"></span>前端开发</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>技术</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fe/html/" class="nav-link" aria-label="HTML"><span class="icon iconfont icon-html"></span>HTML<!----></a></li><li class="dropdown-subitem"><a href="/fe/css/" class="nav-link" aria-label="CSS"><span class="icon iconfont icon-css"></span>CSS<!----></a></li><li class="dropdown-subitem"><a href="/fe/javascript/" class="nav-link" aria-label="JavaScript"><span class="icon iconfont icon-javascript"></span>JavaScript<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fe/vue/" class="nav-link" aria-label="Vue"><span class="icon iconfont icon-vue"></span>Vue<!----></a></li><li class="dropdown-subitem"><a href="/fe/wxapp/" class="nav-link" aria-label="微信小程序"><span class="icon iconfont icon-wechat"></span>微信小程序<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="后端开发"><span class="title"><span class="icon iconfont icon-creative"></span>后端开发</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/rd/java/" class="nav-link" aria-label="Java"><span class="icon iconfont icon-java"></span>Java<!----></a></li><li class="dropdown-item"><a href="/rd/linux/" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-linux"></span>Linux<!----></a></li><li class="dropdown-item"><a href="/rd/sql/" class="nav-link" aria-label="SQL"><span class="icon iconfont icon-mysql"></span>SQL<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程笔记"><span class="title"><span class="icon iconfont icon-code"></span>编程笔记</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/notes/" class="nav-link" aria-label="总览"><span class="icon iconfont icon-creative"></span>总览<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>前端笔记</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notes/javascript/" class="nav-link" aria-label="JavaScript"><span class="icon iconfont icon-javascript"></span>JavaScript<!----></a></li><li class="dropdown-subitem"><a href="/notes/typescript/" class="nav-link" aria-label="TypeScript"><span class="icon iconfont icon-typescript"></span>TypeScript<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>后端笔记</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notes/java/" class="nav-link" aria-label="Java"><span class="icon iconfont icon-article"></span>Java<!----></a></li><li class="dropdown-subitem"><a href="/notes/JDBC.html" class="nav-link" aria-label="JDBC"><span class="icon iconfont icon-article"></span>JDBC<!----></a></li><li class="dropdown-subitem"><a href="/notes/MySQL.html" class="nav-link" aria-label="MySQL"><span class="icon iconfont icon-article"></span>MySQL<!----></a></li><li class="dropdown-subitem"><a href="/notes/MyBatis.html" class="nav-link" aria-label="MyBatis"><span class="icon iconfont icon-article"></span>MyBatis<!----></a></li><li class="dropdown-subitem"><a href="/notes/Redis.html" class="nav-link" aria-label="Redis"><span class="icon iconfont icon-article"></span>Redis<!----></a></li><li class="dropdown-subitem"><a href="/notes/Linux.html" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-article"></span>Linux<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="技术文档"><span class="title"><span class="icon iconfont icon-repo"></span>技术文档</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/technology/" class="nav-link" aria-label="总览"><span class="icon iconfont icon-creative"></span>总览<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>文档列表</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/html/" class="nav-link" aria-label="html"><span class="icon iconfont icon-article"></span>html<!----></a></li><li class="dropdown-subitem"><a href="/technology/javascript/" class="nav-link" aria-label="javascript"><span class="icon iconfont icon-article"></span>javascript<!----></a></li><li class="dropdown-subitem"><a href="/technology/es6/" class="nav-link" aria-label="es6"><span class="icon iconfont icon-article"></span>es6<!----></a></li><li class="dropdown-subitem"><a href="/technology/webapi/" class="nav-link" aria-label="webapi"><span class="icon iconfont icon-article"></span>webapi<!----></a></li><li class="dropdown-subitem"><a href="/technology/bash/" class="nav-link" aria-label="bash"><span class="icon iconfont icon-article"></span>bash<!----></a></li><li class="dropdown-subitem"><a href="/technology/ssh/" class="nav-link active" aria-label="ssh"><span class="icon iconfont icon-article"></span>ssh<!----></a></li><li class="dropdown-subitem"><a href="/technology/git/" class="nav-link" aria-label="git"><span class="icon iconfont icon-article"></span>git<!----></a></li><li class="dropdown-subitem"><a href="/technology/github/" class="nav-link" aria-label="github"><span class="icon iconfont icon-article"></span>github<!----></a></li><li class="dropdown-subitem"><a href="/technology/ts_axios/" class="nav-link" aria-label="ts_axios"><span class="icon iconfont icon-article"></span>ts_axios<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/software/" class="nav-link" aria-label="软件教程"><span class="icon iconfont icon-software"></span>软件教程<!----></a></div><div class="nav-item hide-in-mobile"><a href="/about/" class="nav-link" aria-label="关于"><span class="icon iconfont icon-profile"></span>关于<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="常用链接"><span class="title"><span class="icon iconfont icon-link"></span>常用链接</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="https://cn.vuejs.org/guide/introduction.html" rel="noopener noreferrer" target="_blank" aria-label="Vue3 " class="nav-link"><!---->Vue3 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://router.vuejs.org/zh/introduction.html" rel="noopener noreferrer" target="_blank" aria-label="VueRouter " class="nav-link"><!---->VueRouter <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://vuex.vuejs.org/zh/guide/" rel="noopener noreferrer" target="_blank" aria-label="Vuex " class="nav-link"><!---->Vuex <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://pinia.vuejs.org/zh/introduction.html" rel="noopener noreferrer" target="_blank" aria-label="Pinia " class="nav-link"><!---->Pinia <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://v2.vuepress.vuejs.org/zh/guide/getting-started.html" rel="noopener noreferrer" target="_blank" aria-label="VuePress " class="nav-link"><!---->VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://cn.vitejs.dev/guide/" rel="noopener noreferrer" target="_blank" aria-label="Vite " class="nav-link"><!---->Vite <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://cli.vuejs.org/zh/guide/" rel="noopener noreferrer" target="_blank" aria-label="VueCli " class="nav-link"><!---->VueCli <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="主题文档 " class="nav-link"><!---->主题文档 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/sunzhenyang/sunzhenyang.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div id="docsearch-container"></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/technology/ssh/intro.html" class="nav-link sidebar-link sidebar-page" aria-label="简介"><span class="icon iconfont icon-article"></span>简介<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/technology/ssh/client.html" class="nav-link sidebar-link sidebar-page" aria-label="客户端"><span class="icon iconfont icon-article"></span>客户端<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/technology/ssh/key.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="密钥登录"><span class="icon iconfont icon-article"></span>密钥登录<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#密钥是什么" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="密钥是什么"><!---->密钥是什么<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#密钥登录的过程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="密钥登录的过程"><!---->密钥登录的过程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#ssh-keygen命令-生成密钥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ssh-keygen命令：生成密钥"><!---->ssh-keygen命令：生成密钥<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#基本用法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基本用法"><!---->基本用法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#配置项" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="配置项"><!---->配置项<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#手动上传公钥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="手动上传公钥"><!---->手动上传公钥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#ssh-copy-id-命令-自动上传公钥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ssh-copy-id 命令：自动上传公钥"><!---->ssh-copy-id 命令：自动上传公钥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#ssh-agent-命令-ssh-add-命令" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ssh-agent 命令，ssh-add 命令"><!---->ssh-agent 命令，ssh-add 命令<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#基本用法-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基本用法"><!---->基本用法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#ssh-add命令" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ssh-add命令"><!---->ssh-add命令<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/technology/ssh/key.html#关闭密码登录" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="关闭密码登录"><!---->关闭密码登录<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/technology/ssh/server.html" class="nav-link sidebar-link sidebar-page" aria-label="服务器"><span class="icon iconfont icon-article"></span>服务器<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/technology/ssh/port-forwarding.html" class="nav-link sidebar-link sidebar-page" aria-label="端口转发"><span class="icon iconfont icon-article"></span>端口转发<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/technology/ssh/ca.html" class="nav-link sidebar-link sidebar-page" aria-label="证书登录"><span class="icon iconfont icon-article"></span>证书登录<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/technology/ssh/scp.html" class="nav-link sidebar-link sidebar-page" aria-label="scp 命令"><span class="icon iconfont icon-article"></span>scp 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/technology/ssh/rsync.html" class="nav-link sidebar-link sidebar-page" aria-label="rsync 命令"><span class="icon iconfont icon-article"></span>rsync 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/technology/ssh/sftp.html" class="nav-link sidebar-link sidebar-page" aria-label="sftp 命令"><span class="icon iconfont icon-article"></span>sftp 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-article"></span>密钥登录</h1><div class="page-info"><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年10月14日</span><meta property="datePublished" content="2022-10-14T09:12:02.000Z"></span><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" localizeddate="2022年10月14日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://sunzhenyang.github.io/" target="_blank" rel="noopener noreferrer">Yang</a></span><span property="author" content="Yang"></span></span><!----><span class="category-info" aria-label="分类🌈" data-balloon-pos="down" localizeddate="2022年10月14日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category7" role>ssh</li><meta property="articleSection" content="ssh"></ul></span><span aria-label="标签🏷" data-balloon-pos="down" localizeddate="2022年10月14日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag7" role>ssh</li></ul><meta property="keywords" content="ssh"></span><span class="words-info" aria-label="字数🔠" data-balloon-pos="down" localizeddate="2022年10月14日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 3094 字</span><meta property="wordCount" content="3094"></span><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" localizeddate="2022年10月14日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 10 分钟</span><meta property="timeRequired" content="PT10M"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#密钥是什么" class="router-link-active router-link-exact-active toc-link level2">密钥是什么</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#密钥登录的过程" class="router-link-active router-link-exact-active toc-link level2">密钥登录的过程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#ssh-keygen命令-生成密钥" class="router-link-active router-link-exact-active toc-link level2">ssh-keygen命令：生成密钥</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#基本用法" class="router-link-active router-link-exact-active toc-link level3">基本用法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#配置项" class="router-link-active router-link-exact-active toc-link level3">配置项</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#手动上传公钥" class="router-link-active router-link-exact-active toc-link level2">手动上传公钥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#ssh-copy-id-命令-自动上传公钥" class="router-link-active router-link-exact-active toc-link level2">ssh-copy-id 命令：自动上传公钥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#ssh-agent-命令-ssh-add-命令" class="router-link-active router-link-exact-active toc-link level2">ssh-agent 命令，ssh-add 命令</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#基本用法-1" class="router-link-active router-link-exact-active toc-link level3">基本用法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#ssh-add命令" class="router-link-active router-link-exact-active toc-link level3">ssh-add命令</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/technology/ssh/key.html#关闭密码登录" class="router-link-active router-link-exact-active toc-link level2">关闭密码登录</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><p>SSH 默认采用密码登录，这种方法有很多缺点，简单的密码不安全，复杂的密码不容易记忆，每次手动输入也很麻烦。密钥登录是比密码登录更好的解决方案。</p><h2 id="密钥是什么" tabindex="-1"><a class="header-anchor" href="#密钥是什么" aria-hidden="true">#</a> 密钥是什么</h2><p>密钥（key）是一个非常大的数字，通过加密算法得到。对称加密只需要一个密钥，非对称加密需要两个密钥成对使用，分为公钥（public key）和私钥（private key）。</p><p>SSH 密钥登录采用的是非对称加密，每个用户通过自己的密钥登录。其中，私钥必须私密保存，不能泄漏；公钥则是公开的，可以对外发送。它们的关系是，公钥和私钥是一一对应的，每一个私钥都有且仅有一个对应的公钥，反之亦然。</p><p>如果数据使用公钥加密，那么只有使用对应的私钥才能解密，其他密钥都不行；反过来，如果使用私钥加密（这个过程一般称为“签名”），也只有使用对应的公钥解密。</p><h2 id="密钥登录的过程" tabindex="-1"><a class="header-anchor" href="#密钥登录的过程" aria-hidden="true">#</a> 密钥登录的过程</h2><p>SSH 密钥登录分为以下的步骤。</p><p>预备步骤，客户端通过<code>ssh-keygen</code>生成自己的公钥和私钥。</p><p>第一步，手动将客户端的公钥放入远程服务器的指定位置。</p><p>第二步，客户端向服务器发起 SSH 登录的请求。</p><p>第三步，服务器收到用户 SSH 登录的请求，发送一些随机数据给用户，要求用户证明自己的身份。</p><p>第四步，客户端收到服务器发来的数据，使用私钥对数据进行签名，然后再发还给服务器。</p><p>第五步，服务器收到客户端发来的加密签名后，使用对应的公钥解密，然后跟原始数据比较。如果一致，就允许用户登录。</p><h2 id="ssh-keygen命令-生成密钥" tabindex="-1"><a class="header-anchor" href="#ssh-keygen命令-生成密钥" aria-hidden="true">#</a> <code>ssh-keygen</code>命令：生成密钥</h2><h3 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法" aria-hidden="true">#</a> 基本用法</h3><p>密钥登录时，首先需要生成公钥和私钥。OpenSSH 提供了一个工具程序<code>ssh-keygen</code>命令，用来生成密钥。</p><p>直接输入<code>ssh-keygen</code>，程序会询问一系列问题，然后生成密钥。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>通常做法是使用<code>-t</code>参数，指定密钥的加密算法。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -t dsa
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面示例中，<code>-t</code>参数用来指定密钥的加密算法，一般会选择 DSA 算法或 RSA 算法。如果省略该参数，默认使用 RSA 算法。</p><p>输入上面的命令以后，<code>ssh-keygen</code>会要求用户回答一些问题。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -t dsa
Generating public/private dsa key pair.
Enter <span class="token function">file</span> <span class="token keyword">in</span> <span class="token function">which</span> to save the key <span class="token punctuation">(</span>/home/username/.ssh/id_dsa<span class="token punctuation">)</span>:  press ENTER
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>: ********
Enter same passphrase again: ********
Your identification has been saved <span class="token keyword">in</span> /home/username/.ssh/id_dsa.
Your public key has been saved <span class="token keyword">in</span> /home/username/.ssh/id_dsa.pub.
The key fingerprint is:
<span class="token number">14</span>:ba:06:98:a8:98:ad:27:b5:ce:55:85:ec:64:37:19 username@shell.isp.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面示例中，执行<code>ssh-keygen</code>命令以后，会出现第一个问题，询问密钥保存的文件名，默认是<code>~/.ssh/id_dsa</code>文件，这个是私钥的文件名，对应的公钥文件<code>~/.ssh/id_dsa.pub</code>是自动生成的。用户的密钥一般都放在主目录的<code>.ssh</code>目录里面。</p><p>如果选择<code>rsa</code>算法，生成的密钥文件默认就会是<code>~/.ssh/id_rsa</code>（私钥）和<code>~/.ssh/id_rsa.pub</code>（公钥）。</p><p>接着，就会是第二个问题，询问是否要为私钥文件设定密码保护（passphrase）。这样的话，即使入侵者拿到私钥，还是需要破解密码。如果为了方便，不想设定密码保护，可以直接按回车键，密码就会为空。后面还会让你再输入一次密码，两次输入必须一致。注意，这里“密码”的英文单词是 passphrase，这是为了避免与 Linux 账户的密码单词 password 混淆，表示这不是用户系统账户的密码。</p><p>最后，就会生成私钥和公钥，屏幕上还会给出公钥的指纹，以及当前的用户名和主机名作为注释，用来识别密钥的来源。</p><p>公钥文件和私钥文件都是文本文件，可以用文本编辑器看一下它们的内容。公钥文件的内容类似下面这样。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAvpB4lUbAaEbh9u6HLig7amsfywD4fqSZq2ikACIUBn3GyRPfeF93l/
weQh702ofXbDydZAKMcDvBJqRhUotQUwqV6HJxqoqPDlPGUUyo8RDIkLUIPRyq
ypZxmK9aCXokFiHoGCXfQ9imUP/w/jfqb9ByDtG97tUJF6nFMP5WzhM<span class="token operator">=</span> username@shell.isp.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面示例中，末尾的<code>username@shell.isp.com</code>是公钥的注释，用来识别不同的公钥，表示这是哪台主机（<code>shell.isp.com</code>）的哪个用户（<code>username</code>）的公钥，不是必需项。</p><p>注意，公钥只有一行。因为它太长了，所以上面分成三行显示。</p><p>下面的命令可以列出用户所有的公钥。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ls</span> -l ~/.ssh/id_*.pub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>生成密钥以后，建议修改它们的权限，防止其他人读取。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/id_rsa
$ <span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/id_rsa.pub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置项" tabindex="-1"><a class="header-anchor" href="#配置项" aria-hidden="true">#</a> 配置项</h3><p><code>ssh-keygen</code>的命令行配置项，主要有下面这些。</p><p><strong>（1）<code>-b</code></strong></p><p><code>-b</code>参数指定密钥的二进制位数。这个参数值越大，密钥就越不容易破解，但是加密解密的计算开销也会加大。</p><p>一般来说，<code>-b</code>至少应该是<code>1024</code>，更安全一些可以设为<code>2048</code>或者更高。</p><p><strong>（2）<code>-C</code></strong></p><p><code>-C</code>参数可以为密钥文件指定新的注释，格式为<code>username@host</code>。</p><p>下面命令生成一个4096位 RSA 加密算法的密钥对，并且给出了用户名和主机名。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -t rsa -b <span class="token number">4096</span> -C <span class="token string">&quot;your_email@domain.com&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（3）<code>-f</code></strong></p><p><code>-f</code>参数指定生成的私钥文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -t dsa -f mykey
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面命令会在当前目录生成私钥文件<code>mykey</code>和公钥文件<code>mykey.pub</code>。</p><p><strong>（4）<code>-F</code></strong></p><p><code>-F</code>参数检查某个主机名是否在<code>known_hosts</code>文件里面。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -F example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（5）<code>-N</code></strong></p><p><code>-N</code>参数用于指定私钥的密码（passphrase）。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -t dsa -N secretword
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（6）<code>-p</code></strong></p><p><code>-p</code>参数用于重新指定私钥的密码（passphrase）。它与<code>-N</code>的不同之处在于，新密码不在命令中指定，而是执行后再输入。ssh 先要求输入旧密码，然后要求输入两遍新密码。</p><p><strong>（7）<code>-R</code></strong></p><p><code>-R</code>参数将指定的主机公钥指纹移出<code>known_hosts</code>文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-keygen -R example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（8）<code>-t</code></strong></p><p><code>-t</code>参数用于指定生成密钥的加密算法，一般为<code>dsa</code>或<code>rsa</code></p><h2 id="手动上传公钥" tabindex="-1"><a class="header-anchor" href="#手动上传公钥" aria-hidden="true">#</a> 手动上传公钥</h2><p>生成密钥以后，公钥必须上传到服务器，才能使用公钥登录。</p><p>OpenSSH 规定，用户公钥保存在服务器的<code>~/.ssh/authorized_keys</code>文件。你要以哪个用户的身份登录到服务器，密钥就必须保存在该用户主目录的<code>~/.ssh/authorized_keys</code>文件。只要把公钥添加到这个文件之中，就相当于公钥上传到服务器了。每个公钥占据一行。如果该文件不存在，可以手动创建。</p><p>用户可以手动编辑该文件，把公钥粘贴进去，也可以在本机计算机上，执行下面的命令。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">|</span> <span class="token function">ssh</span> user@host <span class="token string">&quot;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面示例中，<code>user@host</code>要替换成你所要登录的用户名和主机名。</p><p>注意，<code>authorized_keys</code>文件的权限要设为<code>644</code>，即只有文件所有者才能写。如果权限设置不对，SSH 服务器可能会拒绝读取该文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">chmod</span> <span class="token number">644</span> ~/.ssh/authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>只要公钥上传到服务器，下次登录时，OpenSSH 就会自动采用密钥登录，不再提示输入密码。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ssh</span> -l username shell.isp.com
Enter passphrase <span class="token keyword">for</span> key <span class="token string">&#39;/home/you/.ssh/id_dsa&#39;</span><span class="token builtin class-name">:</span> ************
Last login: Mon Mar <span class="token number">24</span> 02:17:27 <span class="token number">2014</span> from ex.ample.com
shell.isp.com<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面例子中，SSH 客户端使用私钥之前，会要求用户输入密码（passphrase），用来解开私钥。</p><h2 id="ssh-copy-id-命令-自动上传公钥" tabindex="-1"><a class="header-anchor" href="#ssh-copy-id-命令-自动上传公钥" aria-hidden="true">#</a> ssh-copy-id 命令：自动上传公钥</h2><p>OpenSSH 自带一个<code>ssh-copy-id</code>命令，可以自动将公钥拷贝到远程服务器的<code>~/.ssh/authorized_keys</code>文件。如果<code>~/.ssh/authorized_keys</code>文件不存在，<code>ssh-copy-id</code>命令会自动创建该文件。</p><p>用户在本地计算机执行下面的命令，就可以把本地的公钥拷贝到服务器。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-copy-id -i key_file user@host
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面命令中，<code>-i</code>参数用来指定公钥文件，<code>user</code>是所要登录的账户名，<code>host</code>是服务器地址。如果省略用户名，默认为当前的本机用户名。执行完该命令，公钥就会拷贝到服务器。</p><p>注意，公钥文件可以不指定路径和<code>.pub</code>后缀名，<code>ssh-copy-id</code>会自动在<code>~/.ssh</code>目录里面寻找。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-copy-id -i id_rsa user@host
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面命令中，公钥文件会自动匹配到<code>~/.ssh/id_rsa.pub</code>。</p><p><code>ssh-copy-id</code>会采用密码登录，系统会提示输入远程服务器的密码。</p><p>注意，<code>ssh-copy-id</code>是直接将公钥添加到<code>authorized_keys</code>文件的末尾。如果<code>authorized_keys</code>文件的末尾不是一个换行符，会导致新的公钥添加到前一个公钥的末尾，两个公钥连在一起，使得它们都无法生效。所以，如果<code>authorized_keys</code>文件已经存在，使用<code>ssh-copy-id</code>命令之前，务必保证<code>authorized_keys</code>文件的末尾是换行符（假设该文件已经存在）。</p><h2 id="ssh-agent-命令-ssh-add-命令" tabindex="-1"><a class="header-anchor" href="#ssh-agent-命令-ssh-add-命令" aria-hidden="true">#</a> ssh-agent 命令，ssh-add 命令</h2><h3 id="基本用法-1" tabindex="-1"><a class="header-anchor" href="#基本用法-1" aria-hidden="true">#</a> 基本用法</h3><p>私钥设置了密码以后，每次使用都必须输入密码，有时让人感觉非常麻烦。比如，连续使用<code>scp</code>命令远程拷贝文件时，每次都要求输入密码。</p><p><code>ssh-agent</code>命令就是为了解决这个问题而设计的，它让用户在整个 Bash 对话（session）之中，只在第一次使用 SSH 命令时输入密码，然后将私钥保存在内存中，后面都不需要再输入私钥的密码了。</p><p>第一步，使用下面的命令新建一次命令行对话。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-agent <span class="token function">bash</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面命令中，如果你使用的命令行环境不是 Bash，可以用其他的 Shell 命令代替。比如<code>zsh</code>和<code>fish</code>。</p><p>如果想在当前对话启用<code>ssh-agent</code>，可以使用下面的命令。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">eval</span> <span class="token variable"><span class="token variable">`</span>ssh-agent<span class="token variable">`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面命令中，<code>ssh-agent</code>会先自动在后台运行，并将需要设置的环境变量输出在屏幕上，类似下面这样。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-agent
<span class="token assign-left variable"><span class="token environment constant">SSH_AUTH_SOCK</span></span><span class="token operator">=</span>/tmp/ssh-barrett/ssh-22841-agent<span class="token punctuation">;</span> <span class="token builtin class-name">export</span> <span class="token environment constant">SSH_AUTH_SOCK</span><span class="token punctuation">;</span>
<span class="token assign-left variable">SSH_AGENT_PID</span><span class="token operator">=</span><span class="token number">22842</span><span class="token punctuation">;</span> <span class="token builtin class-name">export</span> SSH_AGENT_PID<span class="token punctuation">;</span>
<span class="token builtin class-name">echo</span> Agent pid <span class="token number">22842</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>eval</code>命令的作用，就是运行上面的<code>ssh-agent</code>命令的输出，设置环境变量。</p><p>第二步，在新建的 Shell 对话里面，使用<code>ssh-add</code>命令添加默认的私钥（比如<code>~/.ssh/id_rsa</code>，或<code>~/.ssh/id_dsa</code>，或<code>~/.ssh/id_ecdsa</code>，或<code>~/.ssh/id_ed25519</code>）。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-add
Enter passphrase <span class="token keyword">for</span> /home/you/.ssh/id_dsa: ********
Identity added: /home/you/.ssh/id_dsa <span class="token punctuation">(</span>/home/you/.ssh/id_dsa<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面例子中，添加私钥时，会要求输入密码。以后，在这个对话里面再使用密钥时，就不需要输入私钥的密码了，因为私钥已经加载到内存里面了。</p><p>如果添加的不是默认私钥，<code>ssh-add</code>命令需要显式指定私钥文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-add my-other-key-file
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面的命令中，<code>my-other-key-file</code>就是用户指定的私钥文件。</p><p>第三步，使用 ssh 命令正常登录远程服务器。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ssh</span> remoteHost
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面命令中，<code>remoteHost</code>是远程服务器的地址，ssh 使用的是默认的私钥。这时如果私钥设有密码，ssh 将不再询问密码，而是直接取出内存里面的私钥。</p><p>如果要使用其他私钥登录服务器，需要使用 ssh 命令的<code>-i</code>参数指定私钥文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ssh</span> –i OpenSSHPrivateKey remoteHost
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>最后，如果要退出<code>ssh-agent</code>，可以直接退出子 Shell（按下 Ctrl + d），也可以使用下面的命令。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-agent -k
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ssh-add命令" tabindex="-1"><a class="header-anchor" href="#ssh-add命令" aria-hidden="true">#</a> <code>ssh-add</code>命令</h3><p><code>ssh-add</code>命令用来将私钥加入<code>ssh-agent</code>，它有如下的参数。</p><p><strong>（1）<code>-d</code></strong></p><p><code>-d</code>参数从内存中删除指定的私钥。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-add -d name-of-key-file
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（2）<code>-D</code></strong></p><p><code>-D</code>参数从内存中删除所有已经添加的私钥。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-add -D
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>（3）<code>-l</code></strong></p><p><code>-l</code>参数列出所有已经添加的私钥。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ssh-add -l
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="关闭密码登录" tabindex="-1"><a class="header-anchor" href="#关闭密码登录" aria-hidden="true">#</a> 关闭密码登录</h2><p>为了安全性，启用密钥登录之后，最好关闭服务器的密码登录。</p><p>对于 OpenSSH，具体方法就是打开服务器 sshd 的配置文件<code>/etc/ssh/sshd_config</code>，将<code>PasswordAuthentication</code>这一项设为<code>no</code>。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>PasswordAuthentication no
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改配置文件以后，不要忘了重新启动 sshd，否则不会生效。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/sunzhenyang/sunzhenyang.github.io/edit/main/technology/ssh/key.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/10/14 17:12:02</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 874530670@qq.com">sunzhenyang</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/technology/ssh/client.html" class="nav-link prev" aria-label="客户端"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><span class="icon iconfont icon-article"></span>客户端</div></a><a href="/technology/ssh/server.html" class="nav-link next" aria-label="服务器"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">服务器<span class="icon iconfont icon-article"></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">今日事，今日毕！</div><div class="copyright">Copyright by 阮一峰</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.5b67e1df.js" defer></script>
  </body>
</html>
