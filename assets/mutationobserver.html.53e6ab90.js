import{_ as t,o as p,c as o,a as n,b as e,e as c,d as s,r as i}from"./app.d392b00a.js";const l={},u=c(`<h2 id="\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u6982\u8FF0" aria-hidden="true">#</a> \u6982\u8FF0</h2><p>Mutation Observer API \u7528\u6765\u76D1\u89C6 DOM \u53D8\u52A8\u3002DOM \u7684\u4EFB\u4F55\u53D8\u52A8\uFF0C\u6BD4\u5982\u8282\u70B9\u7684\u589E\u51CF\u3001\u5C5E\u6027\u7684\u53D8\u52A8\u3001\u6587\u672C\u5185\u5BB9\u7684\u53D8\u52A8\uFF0C\u8FD9\u4E2A API \u90FD\u53EF\u4EE5\u5F97\u5230\u901A\u77E5\u3002</p><p>\u6982\u5FF5\u4E0A\uFF0C\u5B83\u5F88\u63A5\u8FD1\u4E8B\u4EF6\uFF0C\u53EF\u4EE5\u7406\u89E3\u4E3A DOM \u53D1\u751F\u53D8\u52A8\u5C31\u4F1A\u89E6\u53D1 Mutation Observer \u4E8B\u4EF6\u3002\u4F46\u662F\uFF0C\u5B83\u4E0E\u4E8B\u4EF6\u6709\u4E00\u4E2A\u672C\u8D28\u4E0D\u540C\uFF1A\u4E8B\u4EF6\u662F\u540C\u6B65\u89E6\u53D1\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0CDOM \u7684\u53D8\u52A8\u7ACB\u523B\u4F1A\u89E6\u53D1\u76F8\u5E94\u7684\u4E8B\u4EF6\uFF1BMutation Observer \u5219\u662F\u5F02\u6B65\u89E6\u53D1\uFF0CDOM \u7684\u53D8\u52A8\u5E76\u4E0D\u4F1A\u9A6C\u4E0A\u89E6\u53D1\uFF0C\u800C\u662F\u8981\u7B49\u5230\u5F53\u524D\u6240\u6709 DOM \u64CD\u4F5C\u90FD\u7ED3\u675F\u624D\u89E6\u53D1\u3002</p><p>\u8FD9\u6837\u8BBE\u8BA1\u662F\u4E3A\u4E86\u5E94\u4ED8 DOM \u53D8\u52A8\u9891\u7E41\u7684\u7279\u70B9\u3002\u4E3E\u4F8B\u6765\u8BF4\uFF0C\u5982\u679C\u6587\u6863\u4E2D\u8FDE\u7EED\u63D2\u51651000\u4E2A<code>&lt;p&gt;</code>\u5143\u7D20\uFF0C\u5C31\u4F1A\u8FDE\u7EED\u89E6\u53D11000\u4E2A\u63D2\u5165\u4E8B\u4EF6\uFF0C\u6267\u884C\u6BCF\u4E2A\u4E8B\u4EF6\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u8FD9\u5F88\u53EF\u80FD\u9020\u6210\u6D4F\u89C8\u5668\u7684\u5361\u987F\uFF1B\u800C Mutation Observer \u5B8C\u5168\u4E0D\u540C\uFF0C\u53EA\u57281000\u4E2A\u6BB5\u843D\u90FD\u63D2\u5165\u7ED3\u675F\u540E\u624D\u4F1A\u89E6\u53D1\uFF0C\u800C\u4E14\u53EA\u89E6\u53D1\u4E00\u6B21\u3002</p><p>Mutation Observer \u6709\u4EE5\u4E0B\u7279\u70B9\u3002</p><ul><li>\u5B83\u7B49\u5F85\u6240\u6709\u811A\u672C\u4EFB\u52A1\u5B8C\u6210\u540E\uFF0C\u624D\u4F1A\u8FD0\u884C\uFF08\u5373\u5F02\u6B65\u89E6\u53D1\u65B9\u5F0F\uFF09\u3002</li><li>\u5B83\u628A DOM \u53D8\u52A8\u8BB0\u5F55\u5C01\u88C5\u6210\u4E00\u4E2A\u6570\u7EC4\u8FDB\u884C\u5904\u7406\uFF0C\u800C\u4E0D\u662F\u4E00\u6761\u6761\u4E2A\u522B\u5904\u7406 DOM \u53D8\u52A8\u3002</li><li>\u5B83\u65E2\u53EF\u4EE5\u89C2\u5BDF DOM \u7684\u6240\u6709\u7C7B\u578B\u53D8\u52A8\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u53EA\u89C2\u5BDF\u67D0\u4E00\u7C7B\u53D8\u52A8\u3002</li></ul><h2 id="mutationobserver-\u6784\u9020\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#mutationobserver-\u6784\u9020\u51FD\u6570" aria-hidden="true">#</a> MutationObserver \u6784\u9020\u51FD\u6570</h2><p>\u4F7F\u7528\u65F6\uFF0C\u9996\u5148\u4F7F\u7528<code>MutationObserver</code>\u6784\u9020\u51FD\u6570\uFF0C\u65B0\u5EFA\u4E00\u4E2A\u89C2\u5BDF\u5668\u5B9E\u4F8B\uFF0C\u540C\u65F6\u6307\u5B9A\u8FD9\u4E2A\u5B9E\u4F8B\u7684\u56DE\u8C03\u51FD\u6570\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4EE3\u7801\u4E2D\u7684\u56DE\u8C03\u51FD\u6570\uFF0C\u4F1A\u5728\u6BCF\u6B21 DOM \u53D8\u52A8\u540E\u8C03\u7528\u3002\u8BE5\u56DE\u8C03\u51FD\u6570\u63A5\u53D7\u4E24\u4E2A\u53C2\u6570\uFF0C\u7B2C\u4E00\u4E2A\u662F\u53D8\u52A8\u6570\u7EC4\uFF0C\u7B2C\u4E8C\u4E2A\u662F\u89C2\u5BDF\u5668\u5B9E\u4F8B\uFF0C\u4E0B\u9762\u662F\u4E00\u4E2A\u4F8B\u5B50\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">mutations<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mutations<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mutation</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mutation<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="mutationobserver-\u7684\u5B9E\u4F8B\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#mutationobserver-\u7684\u5B9E\u4F8B\u65B9\u6CD5" aria-hidden="true">#</a> MutationObserver \u7684\u5B9E\u4F8B\u65B9\u6CD5</h2><h3 id="observe" tabindex="-1"><a class="header-anchor" href="#observe" aria-hidden="true">#</a> observe()</h3><p><code>observe()</code>\u65B9\u6CD5\u7528\u6765\u542F\u52A8\u76D1\u542C\uFF0C\u5B83\u63A5\u53D7\u4E24\u4E2A\u53C2\u6570\u3002</p><ul><li>\u7B2C\u4E00\u4E2A\u53C2\u6570\uFF1A\u6240\u8981\u89C2\u5BDF\u7684 DOM \u8282\u70B9</li><li>\u7B2C\u4E8C\u4E2A\u53C2\u6570\uFF1A\u4E00\u4E2A\u914D\u7F6E\u5BF9\u8C61\uFF0C\u6307\u5B9A\u6240\u8981\u89C2\u5BDF\u7684\u7279\u5B9A\u53D8\u52A8</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> article <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;article&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span>  options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&#39;childList&#39;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;attributes&#39;</span><span class="token operator">:</span><span class="token boolean">true</span>
<span class="token punctuation">}</span> <span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>article<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4EE3\u7801\u4E2D\uFF0C<code>observe()</code>\u65B9\u6CD5\u63A5\u53D7\u4E24\u4E2A\u53C2\u6570\uFF0C\u7B2C\u4E00\u4E2A\u662F\u6240\u8981\u89C2\u5BDF\u7684DOM\u5143\u7D20\u662F<code>article</code>\uFF0C\u7B2C\u4E8C\u4E2A\u662F\u6240\u8981\u89C2\u5BDF\u7684\u53D8\u52A8\u7C7B\u578B\uFF08\u5B50\u8282\u70B9\u53D8\u52A8\u548C\u5C5E\u6027\u53D8\u52A8\uFF09\u3002</p><p>\u89C2\u5BDF\u5668\u6240\u80FD\u89C2\u5BDF\u7684 DOM \u53D8\u52A8\u7C7B\u578B\uFF08\u5373\u4E0A\u9762\u4EE3\u7801\u7684<code>options</code>\u5BF9\u8C61\uFF09\uFF0C\u6709\u4EE5\u4E0B\u51E0\u79CD\u3002</p><ul><li><strong>childList</strong>\uFF1A\u5B50\u8282\u70B9\u7684\u53D8\u52A8\uFF08\u6307\u65B0\u589E\uFF0C\u5220\u9664\u6216\u8005\u66F4\u6539\uFF09\u3002</li><li><strong>attributes</strong>\uFF1A\u5C5E\u6027\u7684\u53D8\u52A8\u3002</li><li><strong>characterData</strong>\uFF1A\u8282\u70B9\u5185\u5BB9\u6216\u8282\u70B9\u6587\u672C\u7684\u53D8\u52A8\u3002</li></ul><p>\u60F3\u8981\u89C2\u5BDF\u54EA\u4E00\u79CD\u53D8\u52A8\u7C7B\u578B\uFF0C\u5C31\u5728<code>option</code>\u5BF9\u8C61\u4E2D\u6307\u5B9A\u5B83\u7684\u503C\u4E3A<code>true</code>\u3002\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u81F3\u5C11\u5FC5\u987B\u540C\u65F6\u6307\u5B9A\u8FD9\u4E09\u79CD\u89C2\u5BDF\u7684\u4E00\u79CD\uFF0C\u82E5\u5747\u672A\u6307\u5B9A\u5C06\u62A5\u9519\u3002</p><p>\u9664\u4E86\u53D8\u52A8\u7C7B\u578B\uFF0C<code>options</code>\u5BF9\u8C61\u8FD8\u53EF\u4EE5\u8BBE\u5B9A\u4EE5\u4E0B\u5C5E\u6027\uFF1A</p><ul><li><code>subtree</code>\uFF1A\u5E03\u5C14\u503C\uFF0C\u8868\u793A\u662F\u5426\u5C06\u8BE5\u89C2\u5BDF\u5668\u5E94\u7528\u4E8E\u8BE5\u8282\u70B9\u7684\u6240\u6709\u540E\u4EE3\u8282\u70B9\u3002</li><li><code>attributeOldValue</code>\uFF1A\u5E03\u5C14\u503C\uFF0C\u8868\u793A\u89C2\u5BDF<code>attributes</code>\u53D8\u52A8\u65F6\uFF0C\u662F\u5426\u9700\u8981\u8BB0\u5F55\u53D8\u52A8\u524D\u7684\u5C5E\u6027\u503C\u3002</li><li><code>characterDataOldValue</code>\uFF1A\u5E03\u5C14\u503C\uFF0C\u8868\u793A\u89C2\u5BDF<code>characterData</code>\u53D8\u52A8\u65F6\uFF0C\u662F\u5426\u9700\u8981\u8BB0\u5F55\u53D8\u52A8\u524D\u7684\u503C\u3002</li><li><code>attributeFilter</code>\uFF1A\u6570\u7EC4\uFF0C\u8868\u793A\u9700\u8981\u89C2\u5BDF\u7684\u7279\u5B9A\u5C5E\u6027\uFF08\u6BD4\u5982<code>[&#39;class&#39;,&#39;src&#39;]</code>\uFF09\u3002</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5F00\u59CB\u76D1\u542C\u6587\u6863\u6839\u8282\u70B9\uFF08\u5373&lt;html&gt;\u6807\u7B7E\uFF09\u7684\u53D8\u52A8</span>
mutationObserver<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">characterData</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">attributeOldValue</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">characterDataOldValue</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5BF9\u4E00\u4E2A\u8282\u70B9\u6DFB\u52A0\u89C2\u5BDF\u5668\uFF0C\u5C31\u50CF\u4F7F\u7528<code>addEventListener()</code>\u65B9\u6CD5\u4E00\u6837\uFF0C\u591A\u6B21\u6DFB\u52A0\u540C\u4E00\u4E2A\u89C2\u5BDF\u5668\u662F\u65E0\u6548\u7684\uFF0C\u56DE\u8C03\u51FD\u6570\u4F9D\u7136\u53EA\u4F1A\u89E6\u53D1\u4E00\u6B21\u3002\u5982\u679C\u6307\u5B9A\u4E0D\u540C\u7684<code>options</code>\u5BF9\u8C61\uFF0C\u4EE5\u540E\u9762\u6DFB\u52A0\u7684\u90A3\u4E2A\u4E3A\u51C6\uFF0C\u7C7B\u4F3C\u8986\u76D6\u3002</p><p>\u4E0B\u9762\u7684\u4F8B\u5B50\u662F\u89C2\u5BDF\u65B0\u589E\u7684\u5B50\u8282\u70B9\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> insertedNodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mutations</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mutations<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mutation</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mutation<span class="token punctuation">.</span>addedNodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      insertedNodes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>mutation<span class="token punctuation">.</span>addedNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>insertedNodes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="disconnect-takerecords" tabindex="-1"><a class="header-anchor" href="#disconnect-takerecords" aria-hidden="true">#</a> disconnect()\uFF0CtakeRecords()</h3><p><code>disconnect()</code>\u65B9\u6CD5\u7528\u6765\u505C\u6B62\u89C2\u5BDF\u3002\u8C03\u7528\u8BE5\u65B9\u6CD5\u540E\uFF0CDOM \u518D\u53D1\u751F\u53D8\u52A8\uFF0C\u4E5F\u4E0D\u4F1A\u89E6\u53D1\u89C2\u5BDF\u5668\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>takeRecords()</code>\u65B9\u6CD5\u7528\u6765\u6E05\u9664\u53D8\u52A8\u8BB0\u5F55\uFF0C\u5373\u4E0D\u518D\u5904\u7406\u672A\u5904\u7406\u7684\u53D8\u52A8\u3002\u8BE5\u65B9\u6CD5\u8FD4\u56DE\u53D8\u52A8\u8BB0\u5F55\u7684\u6570\u7EC4\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>observer<span class="token punctuation">.</span><span class="token function">takeRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E0B\u9762\u662F\u4E00\u4E2A\u4F8B\u5B50\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u4FDD\u5B58\u6240\u6709\u6CA1\u6709\u88AB\u89C2\u5BDF\u5668\u5904\u7406\u7684\u53D8\u52A8</span>
<span class="token keyword">var</span> changes <span class="token operator">=</span> mutationObserver<span class="token punctuation">.</span><span class="token function">takeRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u505C\u6B62\u89C2\u5BDF</span>
mutationObserver<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="mutationrecord-\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#mutationrecord-\u5BF9\u8C61" aria-hidden="true">#</a> MutationRecord \u5BF9\u8C61</h2><p>DOM \u6BCF\u6B21\u53D1\u751F\u53D8\u5316\uFF0C\u5C31\u4F1A\u751F\u6210\u4E00\u6761\u53D8\u52A8\u8BB0\u5F55\uFF08MutationRecord \u5B9E\u4F8B\uFF09\u3002\u8BE5\u5B9E\u4F8B\u5305\u542B\u4E86\u4E0E\u53D8\u52A8\u76F8\u5173\u7684\u6240\u6709\u4FE1\u606F\u3002Mutation Observer \u5904\u7406\u7684\u5C31\u662F\u4E00\u4E2A\u4E2A<code>MutationRecord</code>\u5B9E\u4F8B\u6240\u7EC4\u6210\u7684\u6570\u7EC4\u3002</p><p><code>MutationRecord</code>\u5BF9\u8C61\u5305\u542B\u4E86DOM\u7684\u76F8\u5173\u4FE1\u606F\uFF0C\u6709\u5982\u4E0B\u5C5E\u6027\uFF1A</p><ul><li><code>type</code>\uFF1A\u89C2\u5BDF\u7684\u53D8\u52A8\u7C7B\u578B\uFF08<code>attributes</code>\u3001<code>characterData</code>\u6216\u8005<code>childList</code>\uFF09\u3002</li><li><code>target</code>\uFF1A\u53D1\u751F\u53D8\u52A8\u7684DOM\u8282\u70B9\u3002</li><li><code>addedNodes</code>\uFF1A\u65B0\u589E\u7684DOM\u8282\u70B9\u3002</li><li><code>removedNodes</code>\uFF1A\u5220\u9664\u7684DOM\u8282\u70B9\u3002</li><li><code>previousSibling</code>\uFF1A\u524D\u4E00\u4E2A\u540C\u7EA7\u8282\u70B9\uFF0C\u5982\u679C\u6CA1\u6709\u5219\u8FD4\u56DE<code>null</code>\u3002</li><li><code>nextSibling</code>\uFF1A\u4E0B\u4E00\u4E2A\u540C\u7EA7\u8282\u70B9\uFF0C\u5982\u679C\u6CA1\u6709\u5219\u8FD4\u56DE<code>null</code>\u3002</li><li><code>attributeName</code>\uFF1A\u53D1\u751F\u53D8\u52A8\u7684\u5C5E\u6027\u3002\u5982\u679C\u8BBE\u7F6E\u4E86<code>attributeFilter</code>\uFF0C\u5219\u53EA\u8FD4\u56DE\u9884\u5148\u6307\u5B9A\u7684\u5C5E\u6027\u3002</li><li><code>oldValue</code>\uFF1A\u53D8\u52A8\u524D\u7684\u503C\u3002\u8FD9\u4E2A\u5C5E\u6027\u53EA\u5BF9<code>attribute</code>\u548C<code>characterData</code>\u53D8\u52A8\u6709\u6548\uFF0C\u5982\u679C\u53D1\u751F<code>childList</code>\u53D8\u52A8\uFF0C\u5219\u8FD4\u56DE<code>null</code>\u3002</li></ul><h2 id="\u5E94\u7528\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u5E94\u7528\u793A\u4F8B" aria-hidden="true">#</a> \u5E94\u7528\u793A\u4F8B</h2><h3 id="\u5B50\u5143\u7D20\u7684\u53D8\u52A8" tabindex="-1"><a class="header-anchor" href="#\u5B50\u5143\u7D20\u7684\u53D8\u52A8" aria-hidden="true">#</a> \u5B50\u5143\u7D20\u7684\u53D8\u52A8</h3><p>\u4E0B\u9762\u7684\u4F8B\u5B50\u8BF4\u660E\u5982\u4F55\u8BFB\u53D6\u53D8\u52A8\u8BB0\u5F55\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">records</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  records<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">record</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Mutation type: &#39;</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Mutation target: &#39;</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> mo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> option <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&#39;childList&#39;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;subtree&#39;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

mo<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">,</span> option<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4EE3\u7801\u7684\u89C2\u5BDF\u5668\uFF0C\u89C2\u5BDF<code>&lt;body&gt;</code>\u7684\u6240\u6709\u4E0B\u7EA7\u8282\u70B9\uFF08<code>childList</code>\u8868\u793A\u89C2\u5BDF\u5B50\u8282\u70B9\uFF0C<code>subtree</code>\u8868\u793A\u89C2\u5BDF\u540E\u4EE3\u8282\u70B9\uFF09\u7684\u53D8\u52A8\u3002\u56DE\u8C03\u51FD\u6570\u4F1A\u5728\u63A7\u5236\u53F0\u663E\u793A\u6240\u6709\u53D8\u52A8\u7684\u7C7B\u578B\u548C\u76EE\u6807\u8282\u70B9\u3002</p><h3 id="\u5C5E\u6027\u7684\u53D8\u52A8" tabindex="-1"><a class="header-anchor" href="#\u5C5E\u6027\u7684\u53D8\u52A8" aria-hidden="true">#</a> \u5C5E\u6027\u7684\u53D8\u52A8</h3><p>\u4E0B\u9762\u7684\u4F8B\u5B50\u8BF4\u660E\u5982\u4F55\u8FFD\u8E2A\u5C5E\u6027\u7684\u53D8\u52A8\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">records</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  records<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">record</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Previous attribute value: &#39;</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> mo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;#my_element&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&#39;attributes&#39;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;attributeOldValue&#39;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

mo<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4EE3\u7801\u5148\u8BBE\u5B9A\u8FFD\u8E2A\u5C5E\u6027\u53D8\u52A8\uFF08<code>&#39;attributes&#39;: true</code>\uFF09\uFF0C\u7136\u540E\u8BBE\u5B9A\u8BB0\u5F55\u53D8\u52A8\u524D\u7684\u503C\u3002\u5B9E\u9645\u53D1\u751F\u53D8\u52A8\u65F6\uFF0C\u4F1A\u5C06\u53D8\u52A8\u524D\u7684\u503C\u663E\u793A\u5728\u63A7\u5236\u53F0\u3002</p><h3 id="\u53D6\u4EE3-domcontentloaded-\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u53D6\u4EE3-domcontentloaded-\u4E8B\u4EF6" aria-hidden="true">#</a> \u53D6\u4EE3 DOMContentLoaded \u4E8B\u4EF6</h3><p>\u7F51\u9875\u52A0\u8F7D\u7684\u65F6\u5019\uFF0CDOM \u8282\u70B9\u7684\u751F\u6210\u4F1A\u4EA7\u751F\u53D8\u52A8\u8BB0\u5F55\uFF0C\u56E0\u6B64\u53EA\u8981\u89C2\u5BDF DOM \u7684\u53D8\u52A8\uFF0C\u5C31\u80FD\u5728\u7B2C\u4E00\u65F6\u95F4\u89E6\u53D1\u76F8\u5173\u4E8B\u4EF6\uFF0C\u4E5F\u5C31\u6CA1\u6709\u5FC5\u8981\u4F7F\u7528<code>DOMContentLoaded</code>\u4E8B\u4EF6\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4EE3\u7801\u4E2D\uFF0C\u76D1\u542C<code>document.documentElement</code>\uFF08\u5373\u7F51\u9875\u7684<code>&lt;html&gt;</code>HTML \u8282\u70B9\uFF09\u7684\u5B50\u8282\u70B9\u7684\u53D8\u52A8\uFF0C<code>subtree</code>\u5C5E\u6027\u6307\u5B9A\u76D1\u542C\u8FD8\u5305\u62EC\u540E\u4EE3\u8282\u70B9\u3002\u56E0\u6B64\uFF0C\u4EFB\u610F\u4E00\u4E2A\u7F51\u9875\u5143\u7D20\u4E00\u65E6\u751F\u6210\uFF0C\u5C31\u80FD\u7ACB\u523B\u88AB\u76D1\u542C\u5230\u3002</p><p>\u4E0B\u9762\u7684\u4EE3\u7801\uFF0C\u4F7F\u7528<code>MutationObserver</code>\u5BF9\u8C61\u5C01\u88C5\u4E00\u4E2A\u76D1\u542C DOM \u751F\u6210\u7684\u51FD\u6570\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">win</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> listeners <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> doc <span class="token operator">=</span> win<span class="token punctuation">.</span>document<span class="token punctuation">;</span>
  <span class="token keyword">var</span> MutationObserver <span class="token operator">=</span> win<span class="token punctuation">.</span>MutationObserver <span class="token operator">||</span> win<span class="token punctuation">.</span>WebKitMutationObserver<span class="token punctuation">;</span>
  <span class="token keyword">var</span> observer<span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token parameter">selector<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// \u50A8\u5B58\u9009\u62E9\u5668\u548C\u56DE\u8C03\u51FD\u6570</span>
    listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">selector</span><span class="token operator">:</span> selector<span class="token punctuation">,</span>
      <span class="token literal-property property">fn</span><span class="token operator">:</span> fn
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>observer<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// \u76D1\u542Cdocument\u53D8\u5316</span>
      observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>check<span class="token punctuation">)</span><span class="token punctuation">;</span>
      observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>documentElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u68C0\u67E5\u8BE5\u8282\u70B9\u662F\u5426\u5DF2\u7ECF\u5728DOM\u4E2D</span>
    <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// \u68C0\u67E5\u662F\u5426\u5339\u914D\u5DF2\u50A8\u5B58\u7684\u8282\u70B9</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> listeners<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> listener <span class="token operator">=</span> listeners<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// \u68C0\u67E5\u6307\u5B9A\u8282\u70B9\u662F\u5426\u6709\u5339\u914D</span>
      <span class="token keyword">var</span> elements <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>listener<span class="token punctuation">.</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> elements<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> element <span class="token operator">=</span> elements<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// \u786E\u4FDD\u56DE\u8C03\u51FD\u6570\u53EA\u4F1A\u5BF9\u8BE5\u5143\u7D20\u8C03\u7528\u4E00\u6B21</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">.</span>ready<span class="token punctuation">)</span><span class="token punctuation">{</span>
          element<span class="token punctuation">.</span>ready <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token comment">// \u5BF9\u8BE5\u8282\u70B9\u8C03\u7528\u56DE\u8C03\u51FD\u6570</span>
          listener<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// \u5BF9\u5916\u66B4\u9732ready</span>
  win<span class="token punctuation">.</span>ready <span class="token operator">=</span> ready<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u4F7F\u7528\u65B9\u6CD5</span>
<span class="token function">ready</span><span class="token punctuation">(</span><span class="token string">&#39;.foo&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u53C2\u8003\u94FE\u63A5" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003\u94FE\u63A5" aria-hidden="true">#</a> \u53C2\u8003\u94FE\u63A5</h2>`,53),r=s("Paul Kinlan, "),d={href:"https://developers.google.com/web/updates/2012/02/Detect-DOM-changes-with-Mutation-Observers",target:"_blank",rel:"noopener noreferrer"},k=s("Detect DOM changes with Mutation Observers"),v=s("Tiffany Brown, "),m={href:"http://dev.opera.com/articles/view/mutation-observers-tutorial/",target:"_blank",rel:"noopener noreferrer"},b=s("Getting to know mutation observers"),h=s("Michal Budzynski, "),y={href:"http://michalbe.blogspot.com/2013/04/javascript-less-known-parts-dom.html",target:"_blank",rel:"noopener noreferrer"},g=s("JavaScript: The less known parts. DOM Mutations"),f=s("Jeff Griffiths, "),w={href:"https://hacks.mozilla.org/2012/05/dom-mutationobserver-reacting-to-dom-changes-without-killing-browser-performance/",target:"_blank",rel:"noopener noreferrer"},M=s("DOM MutationObserver \u2013 reacting to DOM changes without killing browser performance"),O=s("Addy Osmani, "),_={href:"http://addyosmani.com/blog/mutation-observers/",target:"_blank",rel:"noopener noreferrer"},D=s("Detect, Undo And Redo DOM Changes With Mutation Observers"),j=s("Ryan Morr, "),x={href:"http://ryanmorr.com/using-mutation-observers-to-watch-for-element-availability/",target:"_blank",rel:"noopener noreferrer"},L=s("Using Mutation Observers to Watch for Element Availability");function E(N,V){const a=i("ExternalLinkIcon");return p(),o("div",null,[u,n("ul",null,[n("li",null,[r,n("a",d,[k,e(a)])]),n("li",null,[v,n("a",m,[b,e(a)])]),n("li",null,[h,n("a",y,[g,e(a)])]),n("li",null,[f,n("a",w,[M,e(a)])]),n("li",null,[O,n("a",_,[D,e(a)])]),n("li",null,[j,n("a",x,[L,e(a)])])])])}var A=t(l,[["render",E],["__file","mutationobserver.html.vue"]]);export{A as default};
